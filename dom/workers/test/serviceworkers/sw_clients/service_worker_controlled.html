<!--
  Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/
-->
<!DOCTYPE HTML>
<html>
<head>
  <title>controlled page</title>
  <!--
    Paged controlled by a service worker for testing getServiced().
    See bug 982726.
  -->
<script class="testbody" type="text/javascript">
  function fail(msg) {
    info("service_worker_controlled.html: " + msg);
    opener.postMessage("FAIL", "*");
  }

  if (!opener) {
      info("service_worker_controlled.html should not be launched directly!");
  }

  window.onload = function() {
  dump("~*~*~*~*~*~*~*~*~*~*~ Opened window onload triggered\n");
    dump("WAITING ON READY\n\n");
    navigator.serviceWorker.ready.then(function(swr) {
      dump("DONE ON READY\n\n");
      opener.postMessage("READY", "*");
    });
  }

  window.onmessage = function(msg) {
    // forward message to the test page.
    opener.postMessage(msg.data, "*");
  };
</script>

</head>
<body>
</body>
</html>
